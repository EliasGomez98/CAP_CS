import streamlit as st
import numpy as np
import pandas as pd
from io import StringIO

# =========================================================
# 1) INPUTS: FACTORES DE MEJORA
# =========================================================
FM_H_TXT = """
0.0420	0.0418	0.0411	0.0401	0.0387	0.0370	0.0351	0.0330	0.0308	0.0284	0.0260	0.0236	0.0213	0.0190	0.0169	0.0150	0.0133	0.0119	0.0109	0.0102	0.0100
0.0421	0.0418	0.0412	0.0401	0.0387	0.0371	0.0351	0.0330	0.0308	0.0284	0.0260	0.0236	0.0213	0.0190	0.0169	0.0150	0.0133	0.0119	0.0109	0.0102	0.0100
0.0421	0.0418	0.0412	0.0401	0.0387	0.0371	0.0351	0.0330	0.0308	0.0284	0.0260	0.0236	0.0213	0.0190	0.0169	0.0150	0.0133	0.0119	0.0109	0.0102	0.0100
0.0421	0.0419	0.0412	0.0402	0.0388	0.0371	0.0352	0.0331	0.0308	0.0285	0.0261	0.0237	0.0213	0.0191	0.0169	0.0150	0.0133	0.0120	0.0109	0.0102	0.0100
0.0422	0.0420	0.0413	0.0402	0.0389	0.0372	0.0352	0.0331	0.0309	0.0285	0.0261	0.0237	0.0213	0.0191	0.0170	0.0150	0.0133	0.0120	0.0109	0.0102	0.0100
0.0423	0.0420	0.0414	0.0403	0.0389	0.0372	0.0353	0.0332	0.0309	0.0285	0.0261	0.0237	0.0214	0.0191	0.0170	0.0150	0.0134	0.0120	0.0109	0.0102	0.0100
0.0424	0.0421	0.0415	0.0404	0.0390	0.0373	0.0354	0.0333	0.0310	0.0286	0.0262	0.0238	0.0214	0.0191	0.0170	0.0151	0.0134	0.0120	0.0109	0.0102	0.0100
0.0422	0.0420	0.0413	0.0402	0.0388	0.0372	0.0352	0.0331	0.0309	0.0285	0.0261	0.0237	0.0213	0.0191	0.0170	0.0150	0.0133	0.0120	0.0109	0.0102	0.0100
0.0416	0.0413	0.0407	0.0396	0.0383	0.0366	0.0347	0.0327	0.0305	0.0281	0.0258	0.0234	0.0211	0.0189	0.0168	0.0149	0.0133	0.0119	0.0109	0.0102	0.0100
0.0403	0.0400	0.0394	0.0384	0.0371	0.0355	0.0337	0.0317	0.0296	0.0274	0.0251	0.0229	0.0207	0.0185	0.0165	0.0147	0.0131	0.0118	0.0108	0.0102	0.0100
0.0380	0.0378	0.0372	0.0363	0.0351	0.0336	0.0319	0.0301	0.0281	0.0261	0.0240	0.0219	0.0199	0.0179	0.0160	0.0144	0.0129	0.0117	0.0108	0.0102	0.0100
0.0347	0.0345	0.0340	0.0332	0.0321	0.0308	0.0294	0.0277	0.0260	0.0242	0.0224	0.0205	0.0187	0.0170	0.0153	0.0139	0.0126	0.0115	0.0107	0.0102	0.0100
0.0305	0.0303	0.0299	0.0292	0.0284	0.0273	0.0261	0.0247	0.0233	0.0218	0.0202	0.0187	0.0172	0.0158	0.0144	0.0132	0.0121	0.0112	0.0106	0.0101	0.0100
0.0256	0.0255	0.0251	0.0246	0.0240	0.0231	0.0222	0.0212	0.0201	0.0190	0.0178	0.0166	0.0155	0.0144	0.0134	0.0124	0.0116	0.0109	0.0104	0.0101	0.0100
0.0204	0.0203	0.0201	0.0198	0.0193	0.0188	0.0181	0.0175	0.0167	0.0160	0.0152	0.0144	0.0137	0.0129	0.0122	0.0116	0.0111	0.0106	0.0103	0.0101	0.0100
0.0152	0.0151	0.0150	0.0149	0.0146	0.0144	0.0141	0.0137	0.0134	0.0130	0.0126	0.0122	0.0118	0.0115	0.0111	0.0108	0.0105	0.0103	0.0101	0.0100	0.0100
0.0104	0.0104	0.0104	0.0104	0.0104	0.0104	0.0103	0.0103	0.0103	0.0103	0.0102	0.0102	0.0102	0.0101	0.0101	0.0101	0.0100	0.0100	0.0100	0.0100	0.0100
0.0064	0.0065	0.0065	0.0067	0.0068	0.0070	0.0072	0.0074	0.0077	0.0080	0.0082	0.0085	0.0087	0.0090	0.0092	0.0094	0.0096	0.0098	0.0099	0.0100	0.0100
0.0033	0.0034	0.0035	0.0037	0.0040	0.0044	0.0048	0.0052	0.0057	0.0062	0.0067	0.0072	0.0077	0.0081	0.0086	0.0090	0.0093	0.0096	0.0098	0.0100	0.0100
0.0013	0.0013	0.0015	0.0018	0.0022	0.0026	0.0031	0.0037	0.0043	0.0050	0.0056	0.0063	0.0069	0.0075	0.0081	0.0086	0.0091	0.0095	0.0098	0.0099	0.0100
0.0002	0.0003	0.0005	0.0008	0.0013	0.0018	0.0023	0.0030	0.0037	0.0044	0.0051	0.0058	0.0066	0.0072	0.0079	0.0085	0.0090	0.0094	0.0097	0.0099	0.0100
0.0002	0.0002	0.0004	0.0008	0.0012	0.0017	0.0023	0.0029	0.0036	0.0043	0.0051	0.0058	0.0065	0.0072	0.0079	0.0085	0.0090	0.0094	0.0097	0.0099	0.0100
0.0009	0.0009	0.0011	0.0014	0.0018	0.0023	0.0028	0.0034	0.0041	0.0048	0.0054	0.0061	0.0068	0.0074	0.0080	0.0086	0.0091	0.0094	0.0097	0.0099	0.0100
0.0021	0.0022	0.0023	0.0026	0.0029	0.0033	0.0038	0.0043	0.0049	0.0055	0.0061	0.0066	0.0072	0.0078	0.0083	0.0088	0.0092	0.0095	0.0098	0.0099	0.0100
0.0036	0.0037	0.0038	0.0040	0.0043	0.0046	0.0050	0.0054	0.0059	0.0063	0.0068	0.0073	0.0078	0.0082	0.0086	0.0090	0.0093	0.0096	0.0098	0.0100	0.0100
0.0053	0.0053	0.0054	0.0056	0.0058	0.0060	0.0063	0.0066	0.0069	0.0073	0.0076	0.0080	0.0083	0.0087	0.0090	0.0093	0.0095	0.0097	0.0099	0.0100	0.0100
0.0068	0.0068	0.0069	0.0070	0.0071	0.0073	0.0075	0.0077	0.0079	0.0081	0.0084	0.0086	0.0089	0.0091	0.0093	0.0095	0.0097	0.0098	0.0099	0.0100	0.0100
0.0080	0.0080	0.0081	0.0081	0.0082	0.0083	0.0084	0.0086	0.0087	0.0089	0.0090	0.0092	0.0093	0.0094	0.0096	0.0097	0.0098	0.0099	0.0099	0.0100	0.0100
0.0090	0.0090	0.0090	0.0090	0.0091	0.0091	0.0092	0.0093	0.0093	0.0094	0.0095	0.0096	0.0096	0.0097	0.0098	0.0098	0.0099	0.0099	0.0100	0.0100	0.0100
0.0097	0.0097	0.0097	0.0097	0.0097	0.0098	0.0098	0.0098	0.0098	0.0098	0.0099	0.0099	0.0099	0.0099	0.0099	0.0100	0.0100	0.0100	0.0100	0.0100	0.0100
0.0103	0.0103	0.0103	0.0103	0.0103	0.0103	0.0102	0.0102	0.0102	0.0102	0.0102	0.0101	0.0101	0.0101	0.0101	0.0100	0.0100	0.0100	0.0100	0.0100	0.0100
0.0109	0.0109	0.0109	0.0108	0.0108	0.0107	0.0107	0.0106	0.0106	0.0105	0.0104	0.0104	0.0103	0.0102	0.0102	0.0101	0.0101	0.0101	0.0100	0.0100	0.0100
0.0115	0.0115	0.0115	0.0114	0.0113	0.0113	0.0112	0.0111	0.0110	0.0109	0.0107	0.0106	0.0105	0.0104	0.0103	0.0102	0.0102	0.0101	0.0100	0.0100	0.0100
0.0122	0.0121	0.0121	0.0120	0.0119	0.0118	0.0117	0.0116	0.0114	0.0112	0.0111	0.0109	0.0108	0.0106	0.0105	0.0103	0.0102	0.0101	0.0101	0.0100	0.0100
0.0128	0.0128	0.0127	0.0127	0.0125	0.0124	0.0122	0.0120	0.0118	0.0116	0.0114	0.0112	0.0110	0.0108	0.0106	0.0104	0.0103	0.0102	0.0101	0.0100	0.0100
0.0134	0.0134	0.0133	0.0132	0.0130	0.0129	0.0127	0.0124	0.0122	0.0119	0.0117	0.0114	0.0112	0.0110	0.0107	0.0105	0.0104	0.0102	0.0101	0.0100	0.0100
0.0138	0.0138	0.0137	0.0136	0.0134	0.0132	0.0130	0.0127	0.0125	0.0122	0.0119	0.0116	0.0113	0.0111	0.0108	0.0106	0.0104	0.0102	0.0101	0.0100	0.0100
0.0141	0.0141	0.0140	0.0139	0.0137	0.0135	0.0133	0.0130	0.0127	0.0124	0.0121	0.0118	0.0115	0.0112	0.0109	0.0106	0.0104	0.0103	0.0101	0.0100	0.0100
0.0144	0.0144	0.0143	0.0142	0.0140	0.0137	0.0135	0.0132	0.0129	0.0125	0.0122	0.0119	0.0116	0.0112	0.0110	0.0107	0.0105	0.0103	0.0101	0.0100	0.0100
0.0147	0.0147	0.0146	0.0144	0.0142	0.0140	0.0137	0.0134	0.0130	0.0127	0.0123	0.0120	0.0116	0.0113	0.0110	0.0107	0.0105	0.0103	0.0101	0.0100	0.0100
0.0149	0.0149	0.0148	0.0146	0.0144	0.0141	0.0138	0.0135	0.0132	0.0128	0.0124	0.0121	0.0117	0.0114	0.0111	0.0108	0.0105	0.0103	0.0101	0.0100	0.0100
0.0151	0.0150	0.0149	0.0148	0.0145	0.0143	0.0140	0.0136	0.0133	0.0129	0.0125	0.0122	0.0118	0.0114	0.0111	0.0108	0.0105	0.0103	0.0101	0.0100	0.0100
0.0152	0.0152	0.0151	0.0149	0.0147	0.0144	0.0141	0.0137	0.0134	0.0130	0.0126	0.0122	0.0118	0.0115	0.0111	0.0108	0.0105	0.0103	0.0101	0.0100	0.0100
0.0154	0.0153	0.0152	0.0150	0.0148	0.0145	0.0142	0.0138	0.0135	0.0131	0.0127	0.0123	0.0119	0.0115	0.0112	0.0108	0.0106	0.0103	0.0101	0.0100	0.0100
0.0155	0.0155	0.0154	0.0152	0.0149	0.0147	0.0143	0.0140	0.0136	0.0132	0.0128	0.0123	0.0119	0.0116	0.0112	0.0109	0.0106	0.0103	0.0102	0.0100	0.0100
0.0157	0.0157	0.0156	0.0154	0.0151	0.0148	0.0145	0.0141	0.0137	0.0133	0.0129	0.0124	0.0120	0.0116	0.0112	0.0109	0.0106	0.0103	0.0102	0.0100	0.0100
0.0159	0.0159	0.0158	0.0156	0.0153	0.0150	0.0147	0.0143	0.0139	0.0134	0.0130	0.0125	0.0121	0.0117	0.0113	0.0109	0.0106	0.0104	0.0102	0.0100	0.0100
0.0162	0.0162	0.0160	0.0158	0.0156	0.0152	0.0149	0.0145	0.0140	0.0136	0.0131	0.0126	0.0122	0.0117	0.0113	0.0110	0.0106	0.0104	0.0102	0.0100	0.0100
0.0165	0.0164	0.0163	0.0161	0.0158	0.0155	0.0151	0.0146	0.0142	0.0137	0.0132	0.0128	0.0123	0.0118	0.0114	0.0110	0.0107	0.0104	0.0102	0.0100	0.0100
0.0167	0.0167	0.0165	0.0163	0.0160	0.0157	0.0153	0.0148	0.0144	0.0139	0.0134	0.0129	0.0124	0.0119	0.0115	0.0111	0.0107	0.0104	0.0102	0.0100	0.0100
0.0169	0.0169	0.0167	0.0165	0.0162	0.0159	0.0154	0.0150	0.0145	0.0140	0.0135	0.0130	0.0124	0.0120	0.0115	0.0111	0.0107	0.0104	0.0102	0.0101	0.0100
0.0171	0.0170	0.0169	0.0167	0.0164	0.0160	0.0156	0.0151	0.0146	0.0141	0.0135	0.0130	0.0125	0.0120	0.0115	0.0111	0.0107	0.0104	0.0102	0.0101	0.0100
0.0172	0.0171	0.0170	0.0167	0.0164	0.0161	0.0156	0.0152	0.0146	0.0141	0.0136	0.0131	0.0125	0.0120	0.0115	0.0111	0.0107	0.0104	0.0102	0.0101	0.0100
0.0172	0.0171	0.0170	0.0167	0.0164	0.0161	0.0156	0.0152	0.0146	0.0141	0.0136	0.0131	0.0125	0.0120	0.0115	0.0111	0.0107	0.0104	0.0102	0.0101	0.0100
0.0171	0.0171	0.0169	0.0167	0.0164	0.0160	0.0156	0.0151	0.0146	0.0141	0.0136	0.0130	0.0125	0.0120	0.0115	0.0111	0.0107	0.0104	0.0102	0.0101	0.0100
0.0170	0.0170	0.0168	0.0166	0.0163	0.0159	0.0155	0.0150	0.0145	0.0140	0.0135	0.0130	0.0125	0.0120	0.0115	0.0111	0.0107	0.0104	0.0102	0.0101	0.0100
0.0169	0.0169	0.0167	0.0165	0.0162	0.0158	0.0154	0.0150	0.0145	0.0140	0.0135	0.0129	0.0124	0.0119	0.0115	0.0111	0.0107	0.0104	0.0102	0.0101	0.0100
0.0168	0.0167	0.0166	0.0164	0.0161	0.0157	0.0153	0.0149	0.0144	0.0139	0.0134	0.0129	0.0124	0.0119	0.0115	0.0111	0.0107	0.0104	0.0102	0.0100	0.0100
0.0167	0.0167	0.0165	0.0163	0.0160	0.0157	0.0153	0.0148	0.0143	0.0139	0.0134	0.0129	0.0124	0.0119	0.0114	0.0110	0.0107	0.0104	0.0102	0.0100	0.0100
0.0167	0.0166	0.0165	0.0162	0.0160	0.0156	0.0152	0.0148	0.0143	0.0138	0.0133	0.0128	0.0123	0.0119	0.0114	0.0110	0.0107	0.0104	0.0102	0.0100	0.0100
0.0166	0.0166	0.0164	0.0162	0.0159	0.0156	0.0152	0.0147	0.0143	0.0138	0.0133	0.0128	0.0123	0.0119	0.0114	0.0110	0.0107	0.0104	0.0102	0.0100	0.0100
0.0166	0.0165	0.0164	0.0162	0.0159	0.0155	0.0151	0.0147	0.0143	0.0138	0.0133	0.0128	0.0123	0.0118	0.0114	0.0110	0.0107	0.0104	0.0102	0.0100	0.0100
0.0165	0.0164	0.0163	0.0161	0.0158	0.0155	0.0151	0.0147	0.0142	0.0137	0.0132	0.0128	0.0123	0.0118	0.0114	0.0110	0.0107	0.0104	0.0102	0.0100	0.0100
0.0163	0.0163	0.0162	0.0160	0.0157	0.0154	0.0150	0.0146	0.0141	0.0136	0.0132	0.0127	0.0122	0.0118	0.0114	0.0110	0.0107	0.0104	0.0102	0.0100	0.0100
0.0161	0.0160	0.0159	0.0157	0.0155	0.0151	0.0148	0.0144	0.0139	0.0135	0.0130	0.0126	0.0121	0.0117	0.0113	0.0110	0.0106	0.0104	0.0102	0.0100	0.0100
0.0157	0.0156	0.0155	0.0153	0.0151	0.0148	0.0145	0.0141	0.0137	0.0133	0.0128	0.0124	0.0120	0.0116	0.0112	0.0109	0.0106	0.0103	0.0102	0.0100	0.0100
0.0151	0.0151	0.0150	0.0148	0.0146	0.0143	0.0140	0.0137	0.0133	0.0129	0.0126	0.0122	0.0118	0.0114	0.0111	0.0108	0.0105	0.0103	0.0101	0.0100	0.0100
0.0144	0.0144	0.0143	0.0142	0.0140	0.0138	0.0135	0.0132	0.0129	0.0126	0.0122	0.0119	0.0116	0.0113	0.0110	0.0107	0.0105	0.0103	0.0101	0.0100	0.0100
0.0137	0.0137	0.0136	0.0135	0.0133	0.0131	0.0129	0.0127	0.0124	0.0121	0.0118	0.0116	0.0113	0.0110	0.0108	0.0106	0.0104	0.0102	0.0101	0.0100	0.0100
0.0130	0.0129	0.0129	0.0128	0.0127	0.0125	0.0123	0.0121	0.0119	0.0117	0.0115	0.0113	0.0110	0.0108	0.0106	0.0105	0.0103	0.0102	0.0101	0.0100	0.0100
0.0123	0.0123	0.0123	0.0122	0.0121	0.0120	0.0118	0.0117	0.0115	0.0113	0.0112	0.0110	0.0108	0.0107	0.0105	0.0104	0.0102	0.0101	0.0101	0.0100	0.0100
0.0119	0.0119	0.0118	0.0118	0.0117	0.0116	0.0115	0.0113	0.0112	0.0111	0.0109	0.0108	0.0107	0.0105	0.0104	0.0103	0.0102	0.0101	0.0101	0.0100	0.0100
0.0117	0.0117	0.0116	0.0116	0.0115	0.0114	0.0113	0.0112	0.0111	0.0110	0.0108	0.0107	0.0106	0.0105	0.0104	0.0103	0.0102	0.0101	0.0100	0.0100	0.0100
0.0118	0.0117	0.0117	0.0117	0.0116	0.0115	0.0114	0.0113	0.0111	0.0110	0.0109	0.0107	0.0106	0.0105	0.0104	0.0103	0.0102	0.0101	0.0100	0.0100	0.0100
0.0121	0.0121	0.0120	0.0120	0.0119	0.0118	0.0117	0.0115	0.0114	0.0112	0.0111	0.0109	0.0107	0.0106	0.0105	0.0103	0.0102	0.0101	0.0101	0.0100	0.0100
0.0126	0.0126	0.0126	0.0125	0.0124	0.0122	0.0121	0.0119	0.0117	0.0115	0.0113	0.0111	0.0109	0.0107	0.0106	0.0104	0.0103	0.0102	0.0101	0.0100	0.0100
0.0133	0.0133	0.0132	0.0131	0.0130	0.0128	0.0126	0.0124	0.0121	0.0119	0.0117	0.0114	0.0112	0.0109	0.0107	0.0105	0.0103	0.0102	0.0101	0.0100	0.0100
0.0141	0.0141	0.0140	0.0138	0.0137	0.0135	0.0132	0.0129	0.0127	0.0124	0.0120	0.0117	0.0114	0.0112	0.0109	0.0106	0.0104	0.0102	0.0101	0.0100	0.0100
0.0149	0.0149	0.0148	0.0146	0.0144	0.0142	0.0139	0.0135	0.0132	0.0128	0.0125	0.0121	0.0117	0.0114	0.0111	0.0108	0.0105	0.0103	0.0101	0.0100	0.0100
0.0157	0.0157	0.0156	0.0154	0.0151	0.0148	0.0145	0.0141	0.0137	0.0133	0.0129	0.0124	0.0120	0.0116	0.0112	0.0109	0.0106	0.0103	0.0102	0.0100	0.0100
0.0164	0.0163	0.0162	0.0160	0.0157	0.0154	0.0150	0.0146	0.0141	0.0137	0.0132	0.0127	0.0122	0.0118	0.0114	0.0110	0.0107	0.0104	0.0102	0.0100	0.0100
0.0169	0.0168	0.0167	0.0164	0.0162	0.0158	0.0154	0.0149	0.0144	0.0139	0.0134	0.0129	0.0124	0.0119	0.0115	0.0111	0.0107	0.0104	0.0102	0.0100	0.0100
0.0172	0.0171	0.0170	0.0167	0.0164	0.0160	0.0156	0.0151	0.0146	0.0141	0.0136	0.0130	0.0125	0.0120	0.0115	0.0111	0.0107	0.0104	0.0102	0.0101	0.0100
0.0173	0.0172	0.0171	0.0168	0.0165	0.0161	0.0157	0.0152	0.0147	0.0142	0.0136	0.0131	0.0126	0.0120	0.0116	0.0111	0.0108	0.0104	0.0102	0.0101	0.0100
0.0173	0.0172	0.0171	0.0168	0.0165	0.0162	0.0157	0.0152	0.0147	0.0142	0.0136	0.0131	0.0126	0.0121	0.0116	0.0111	0.0108	0.0104	0.0102	0.0101	0.0100
0.0173	0.0172	0.0171	0.0168	0.0165	0.0161	0.0157	0.0152	0.0147	0.0142	0.0136	0.0131	0.0126	0.0120	0.0116	0.0111	0.0108	0.0104	0.0102	0.0101	0.0100
0.0173	0.0172	0.0171	0.0168	0.0165	0.0161	0.0157	0.0152	0.0147	0.0142	0.0136	0.0131	0.0126	0.0120	0.0116	0.0111	0.0108	0.0104	0.0102	0.0101	0.0100
0.0173	0.0172	0.0171	0.0168	0.0165	0.0161	0.0157	0.0152	0.0147	0.0142	0.0136	0.0131	0.0126	0.0120	0.0116	0.0111	0.0108	0.0104	0.0102	0.0101	0.0100
0.0173	0.0172	0.0171	0.0168	0.0165	0.0161	0.0157	0.0152	0.0147	0.0142	0.0136	0.0131	0.0126	0.0120	0.0116	0.0111	0.0108	0.0104	0.0102	0.0101	0.0100
0.0173	0.0172	0.0171	0.0168	0.0165	0.0161	0.0157	0.0152	0.0147	0.0142	0.0136	0.0131	0.0126	0.0120	0.0116	0.0111	0.0108	0.0104	0.0102	0.0101	0.0100
0.0172	0.0172	0.0170	0.0168	0.0165	0.0161	0.0156	0.0152	0.0147	0.0141	0.0136	0.0131	0.0125	0.0120	0.0116	0.0111	0.0107	0.0104	0.0102	0.0101	0.0100
0.0161	0.0160	0.0159	0.0156	0.0154	0.0150	0.0146	0.0142	0.0137	0.0132	0.0127	0.0122	0.0117	0.0112	0.0108	0.0104	0.0100	0.0097	0.0095	0.0094	0.0093
0.0149	0.0149	0.0147	0.0145	0.0143	0.0139	0.0136	0.0132	0.0127	0.0123	0.0118	0.0113	0.0109	0.0104	0.0100	0.0096	0.0093	0.0090	0.0088	0.0087	0.0087
0.0138	0.0137	0.0136	0.0134	0.0132	0.0129	0.0125	0.0121	0.0117	0.0113	0.0109	0.0105	0.0100	0.0096	0.0092	0.0089	0.0086	0.0084	0.0082	0.0080	0.0080
0.0126	0.0126	0.0125	0.0123	0.0121	0.0118	0.0115	0.0111	0.0108	0.0104	0.0100	0.0096	0.0092	0.0088	0.0085	0.0082	0.0079	0.0077	0.0075	0.0074	0.0073
0.0115	0.0114	0.0113	0.0112	0.0110	0.0107	0.0104	0.0101	0.0098	0.0094	0.0091	0.0087	0.0084	0.0080	0.0077	0.0074	0.0072	0.0070	0.0068	0.0067	0.0067
0.0103	0.0103	0.0102	0.0101	0.0099	0.0096	0.0094	0.0091	0.0088	0.0085	0.0082	0.0078	0.0075	0.0072	0.0069	0.0067	0.0064	0.0063	0.0061	0.0060	0.0060
0.0092	0.0091	0.0091	0.0089	0.0088	0.0086	0.0083	0.0081	0.0078	0.0075	0.0073	0.0070	0.0067	0.0064	0.0062	0.0059	0.0057	0.0056	0.0054	0.0054	0.0053
0.0080	0.0080	0.0079	0.0078	0.0077	0.0075	0.0073	0.0071	0.0068	0.0066	0.0063	0.0061	0.0058	0.0056	0.0054	0.0052	0.0050	0.0049	0.0048	0.0047	0.0047
0.0069	0.0069	0.0068	0.0067	0.0066	0.0064	0.0063	0.0061	0.0059	0.0057	0.0054	0.0052	0.0050	0.0048	0.0046	0.0045	0.0043	0.0042	0.0041	0.0040	0.0040
0.0057	0.0057	0.0057	0.0056	0.0055	0.0054	0.0052	0.0051	0.0049	0.0047	0.0045	0.0044	0.0042	0.0040	0.0039	0.0037	0.0036	0.0035	0.0034	0.0034	0.0033
0.0046	0.0046	0.0045	0.0045	0.0044	0.0043	0.0042	0.0040	0.0039	0.0038	0.0036	0.0035	0.0033	0.0032	0.0031	0.0030	0.0029	0.0028	0.0027	0.0027	0.0027
0.0034	0.0034	0.0034	0.0034	0.0033	0.0032	0.0031	0.0030	0.0029	0.0028	0.0027	0.0026	0.0025	0.0024	0.0023	0.0022	0.0021	0.0021	0.0020	0.0020	0.0020
0.0023	0.0023	0.0023	0.0022	0.0022	0.0021	0.0021	0.0020	0.0020	0.0019	0.0018	0.0017	0.0017	0.0016	0.0015	0.0015	0.0014	0.0014	0.0014	0.0013	0.0013
0.0011	0.0011	0.0011	0.0011	0.0011	0.0011	0.0010	0.0010	0.0010	0.0009	0.0009	0.0009	0.0008	0.0008	0.0008	0.0007	0.0007	0.0007	0.0007	0.0007	0.0007
0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000
0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000
0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000
0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000
0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000
0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000
"""

FM_M_TXT = """
0.0463	0.0460	0.0453	0.0441	0.0425	0.0406	0.0384	0.0361	0.0335	0.0308	0.0281	0.0254	0.0228	0.0202	0.0178	0.0157	0.0138	0.0122	0.0110	0.0103	0.0100
0.0460	0.0458	0.0450	0.0438	0.0423	0.0404	0.0382	0.0359	0.0333	0.0307	0.0280	0.0253	0.0227	0.0201	0.0178	0.0156	0.0137	0.0122	0.0110	0.0103	0.0100
0.0456	0.0454	0.0446	0.0435	0.0419	0.0401	0.0379	0.0356	0.0331	0.0305	0.0278	0.0252	0.0225	0.0200	0.0177	0.0156	0.0137	0.0122	0.0110	0.0103	0.0100
0.0455	0.0452	0.0445	0.0433	0.0418	0.0399	0.0378	0.0355	0.0330	0.0304	0.0277	0.0251	0.0225	0.0200	0.0177	0.0155	0.0137	0.0122	0.0110	0.0103	0.0100
0.0450	0.0448	0.0440	0.0429	0.0414	0.0396	0.0375	0.0352	0.0327	0.0301	0.0275	0.0249	0.0223	0.0199	0.0176	0.0155	0.0136	0.0121	0.0110	0.0103	0.0100
0.0446	0.0444	0.0436	0.0425	0.0410	0.0392	0.0371	0.0349	0.0324	0.0299	0.0273	0.0247	0.0222	0.0198	0.0175	0.0154	0.0136	0.0121	0.0110	0.0103	0.0100
0.0440	0.0438	0.0431	0.0419	0.0405	0.0387	0.0367	0.0344	0.0320	0.0296	0.0270	0.0245	0.0220	0.0196	0.0173	0.0153	0.0135	0.0121	0.0110	0.0102	0.0100
0.0430	0.0428	0.0421	0.0410	0.0396	0.0379	0.0359	0.0337	0.0314	0.0290	0.0265	0.0240	0.0216	0.0193	0.0171	0.0152	0.0134	0.0120	0.0109	0.0102	0.0100
0.0418	0.0416	0.0409	0.0399	0.0385	0.0368	0.0349	0.0328	0.0306	0.0283	0.0259	0.0235	0.0212	0.0190	0.0169	0.0150	0.0133	0.0119	0.0109	0.0102	0.0100
0.0403	0.0401	0.0394	0.0384	0.0371	0.0355	0.0337	0.0317	0.0296	0.0274	0.0251	0.0229	0.0207	0.0185	0.0165	0.0147	0.0131	0.0118	0.0108	0.0102	0.0100
0.0386	0.0384	0.0378	0.0369	0.0356	0.0341	0.0324	0.0306	0.0285	0.0264	0.0243	0.0222	0.0201	0.0181	0.0162	0.0145	0.0130	0.0117	0.0108	0.0102	0.0100
0.0368	0.0367	0.0361	0.0352	0.0341	0.0327	0.0310	0.0293	0.0274	0.0254	0.0234	0.0214	0.0194	0.0176	0.0158	0.0142	0.0128	0.0116	0.0108	0.0102	0.0100
0.0353	0.0351	0.0346	0.0338	0.0327	0.0314	0.0298	0.0282	0.0264	0.0245	0.0227	0.0208	0.0189	0.0171	0.0155	0.0140	0.0126	0.0115	0.0107	0.0102	0.0100
0.0338	0.0336	0.0331	0.0323	0.0313	0.0300	0.0286	0.0271	0.0254	0.0237	0.0219	0.0201	0.0184	0.0167	0.0151	0.0137	0.0125	0.0114	0.0107	0.0102	0.0100
0.0325	0.0324	0.0319	0.0312	0.0302	0.0290	0.0277	0.0262	0.0246	0.0230	0.0213	0.0196	0.0179	0.0164	0.0149	0.0135	0.0123	0.0114	0.0106	0.0102	0.0100
0.0313	0.0312	0.0308	0.0301	0.0291	0.0280	0.0267	0.0253	0.0238	0.0223	0.0207	0.0191	0.0175	0.0160	0.0146	0.0133	0.0122	0.0113	0.0106	0.0102	0.0100
0.0303	0.0302	0.0298	0.0291	0.0282	0.0272	0.0260	0.0246	0.0232	0.0217	0.0202	0.0187	0.0172	0.0157	0.0144	0.0132	0.0121	0.0112	0.0106	0.0101	0.0100
0.0295	0.0294	0.0290	0.0284	0.0275	0.0265	0.0253	0.0240	0.0227	0.0212	0.0198	0.0183	0.0169	0.0155	0.0142	0.0131	0.0120	0.0112	0.0105	0.0101	0.0100
0.0286	0.0285	0.0281	0.0275	0.0267	0.0257	0.0246	0.0234	0.0221	0.0207	0.0193	0.0179	0.0166	0.0153	0.0140	0.0129	0.0119	0.0111	0.0105	0.0101	0.0100
0.0279	0.0277	0.0274	0.0268	0.0260	0.0251	0.0240	0.0228	0.0216	0.0203	0.0189	0.0176	0.0163	0.0150	0.0139	0.0128	0.0119	0.0111	0.0105	0.0101	0.0100
0.0271	0.0270	0.0267	0.0261	0.0254	0.0245	0.0234	0.0223	0.0211	0.0199	0.0186	0.0173	0.0160	0.0148	0.0137	0.0127	0.0118	0.0110	0.0105	0.0101	0.0100
0.0266	0.0264	0.0261	0.0256	0.0248	0.0240	0.0230	0.0219	0.0207	0.0195	0.0183	0.0170	0.0158	0.0147	0.0136	0.0126	0.0117	0.0110	0.0105	0.0101	0.0100
0.0261	0.0260	0.0256	0.0251	0.0244	0.0236	0.0226	0.0216	0.0204	0.0193	0.0180	0.0168	0.0157	0.0145	0.0135	0.0125	0.0117	0.0110	0.0105	0.0101	0.0100
0.0256	0.0255	0.0252	0.0247	0.0240	0.0232	0.0222	0.0212	0.0201	0.0190	0.0178	0.0166	0.0155	0.0144	0.0134	0.0124	0.0116	0.0109	0.0104	0.0101	0.0100
0.0250	0.0249	0.0246	0.0241	0.0235	0.0227	0.0218	0.0208	0.0197	0.0186	0.0175	0.0164	0.0153	0.0142	0.0132	0.0123	0.0116	0.0109	0.0104	0.0101	0.0100
0.0243	0.0242	0.0239	0.0235	0.0228	0.0221	0.0212	0.0203	0.0193	0.0182	0.0172	0.0161	0.0150	0.0140	0.0131	0.0122	0.0115	0.0109	0.0104	0.0101	0.0100
0.0235	0.0234	0.0231	0.0227	0.0221	0.0214	0.0206	0.0197	0.0187	0.0178	0.0167	0.0157	0.0147	0.0138	0.0129	0.0121	0.0114	0.0108	0.0104	0.0101	0.0100
0.0225	0.0224	0.0222	0.0217	0.0212	0.0206	0.0198	0.0190	0.0181	0.0172	0.0163	0.0153	0.0144	0.0135	0.0127	0.0120	0.0113	0.0108	0.0104	0.0101	0.0100
0.0215	0.0214	0.0211	0.0208	0.0203	0.0197	0.0190	0.0182	0.0174	0.0166	0.0157	0.0149	0.0140	0.0132	0.0125	0.0118	0.0112	0.0107	0.0103	0.0101	0.0100
0.0204	0.0203	0.0201	0.0198	0.0193	0.0188	0.0182	0.0175	0.0167	0.0160	0.0152	0.0144	0.0137	0.0129	0.0122	0.0116	0.0111	0.0106	0.0103	0.0101	0.0100
0.0194	0.0194	0.0192	0.0188	0.0184	0.0179	0.0174	0.0168	0.0161	0.0154	0.0147	0.0140	0.0133	0.0127	0.0120	0.0115	0.0110	0.0106	0.0103	0.0101	0.0100
0.0186	0.0185	0.0183	0.0180	0.0177	0.0172	0.0167	0.0162	0.0156	0.0149	0.0143	0.0136	0.0130	0.0124	0.0119	0.0113	0.0109	0.0105	0.0102	0.0101	0.0100
0.0179	0.0178	0.0177	0.0174	0.0171	0.0166	0.0162	0.0157	0.0151	0.0145	0.0139	0.0133	0.0128	0.0122	0.0117	0.0112	0.0108	0.0105	0.0102	0.0101	0.0100
0.0174	0.0174	0.0172	0.0170	0.0166	0.0163	0.0158	0.0153	0.0148	0.0143	0.0137	0.0132	0.0126	0.0121	0.0116	0.0112	0.0108	0.0105	0.0102	0.0101	0.0100
0.0172	0.0172	0.0170	0.0168	0.0165	0.0161	0.0157	0.0152	0.0147	0.0142	0.0136	0.0131	0.0125	0.0120	0.0116	0.0111	0.0108	0.0104	0.0102	0.0101	0.0100
0.0173	0.0172	0.0171	0.0168	0.0165	0.0162	0.0157	0.0152	0.0147	0.0142	0.0136	0.0131	0.0126	0.0121	0.0116	0.0111	0.0108	0.0104	0.0102	0.0101	0.0100
0.0175	0.0175	0.0173	0.0171	0.0167	0.0164	0.0159	0.0154	0.0149	0.0143	0.0138	0.0132	0.0127	0.0121	0.0116	0.0112	0.0108	0.0105	0.0102	0.0101	0.0100
0.0179	0.0179	0.0177	0.0174	0.0171	0.0167	0.0162	0.0157	0.0151	0.0146	0.0140	0.0134	0.0128	0.0122	0.0117	0.0112	0.0108	0.0105	0.0102	0.0101	0.0100
0.0184	0.0184	0.0182	0.0179	0.0176	0.0171	0.0166	0.0161	0.0155	0.0148	0.0142	0.0136	0.0130	0.0124	0.0118	0.0113	0.0109	0.0105	0.0102	0.0101	0.0100
0.0190	0.0189	0.0188	0.0185	0.0181	0.0176	0.0171	0.0165	0.0158	0.0152	0.0145	0.0138	0.0132	0.0125	0.0119	0.0114	0.0109	0.0105	0.0103	0.0101	0.0100
0.0196	0.0195	0.0193	0.0190	0.0186	0.0181	0.0175	0.0169	0.0162	0.0155	0.0148	0.0141	0.0134	0.0127	0.0121	0.0115	0.0110	0.0106	0.0103	0.0101	0.0100
0.0200	0.0200	0.0197	0.0194	0.0190	0.0185	0.0179	0.0172	0.0165	0.0158	0.0150	0.0143	0.0135	0.0128	0.0122	0.0116	0.0110	0.0106	0.0103	0.0101	0.0100
0.0204	0.0203	0.0201	0.0198	0.0193	0.0188	0.0181	0.0175	0.0167	0.0160	0.0152	0.0144	0.0137	0.0129	0.0122	0.0116	0.0111	0.0106	0.0103	0.0101	0.0100
0.0207	0.0206	0.0204	0.0200	0.0195	0.0190	0.0184	0.0176	0.0169	0.0161	0.0153	0.0145	0.0137	0.0130	0.0123	0.0117	0.0111	0.0106	0.0103	0.0101	0.0100
0.0208	0.0208	0.0205	0.0202	0.0197	0.0192	0.0185	0.0178	0.0170	0.0162	0.0154	0.0146	0.0138	0.0131	0.0123	0.0117	0.0111	0.0107	0.0103	0.0101	0.0100
0.0210	0.0209	0.0207	0.0203	0.0199	0.0193	0.0186	0.0179	0.0171	0.0163	0.0155	0.0147	0.0139	0.0131	0.0124	0.0117	0.0111	0.0107	0.0103	0.0101	0.0100
0.0211	0.0211	0.0208	0.0205	0.0200	0.0194	0.0187	0.0180	0.0172	0.0164	0.0156	0.0147	0.0139	0.0131	0.0124	0.0117	0.0112	0.0107	0.0103	0.0101	0.0100
0.0213	0.0212	0.0210	0.0206	0.0201	0.0195	0.0189	0.0181	0.0173	0.0165	0.0156	0.0148	0.0140	0.0132	0.0124	0.0118	0.0112	0.0107	0.0103	0.0101	0.0100
0.0215	0.0214	0.0211	0.0208	0.0203	0.0197	0.0190	0.0182	0.0174	0.0166	0.0157	0.0149	0.0140	0.0132	0.0125	0.0118	0.0112	0.0107	0.0103	0.0101	0.0100
0.0216	0.0216	0.0213	0.0209	0.0204	0.0198	0.0191	0.0184	0.0175	0.0167	0.0158	0.0150	0.0141	0.0133	0.0125	0.0118	0.0112	0.0107	0.0103	0.0101	0.0100
0.0218	0.0217	0.0215	0.0211	0.0206	0.0200	0.0193	0.0185	0.0177	0.0168	0.0159	0.0150	0.0142	0.0133	0.0126	0.0118	0.0112	0.0107	0.0103	0.0101	0.0100
0.0220	0.0219	0.0217	0.0213	0.0207	0.0201	0.0194	0.0186	0.0178	0.0169	0.0160	0.0151	0.0142	0.0134	0.0126	0.0119	0.0112	0.0107	0.0103	0.0101	0.0100
0.0221	0.0220	0.0218	0.0214	0.0209	0.0202	0.0195	0.0187	0.0179	0.0170	0.0161	0.0152	0.0143	0.0134	0.0126	0.0119	0.0113	0.0107	0.0103	0.0101	0.0100
0.0222	0.0221	0.0219	0.0215	0.0209	0.0203	0.0196	0.0188	0.0179	0.0170	0.0161	0.0152	0.0143	0.0134	0.0126	0.0119	0.0113	0.0107	0.0103	0.0101	0.0100
0.0222	0.0222	0.0219	0.0215	0.0210	0.0203	0.0196	0.0188	0.0179	0.0170	0.0161	0.0152	0.0143	0.0134	0.0126	0.0119	0.0113	0.0107	0.0103	0.0101	0.0100
0.0222	0.0221	0.0219	0.0215	0.0210	0.0203	0.0196	0.0188	0.0179	0.0170	0.0161	0.0152	0.0143	0.0134	0.0126	0.0119	0.0113	0.0107	0.0103	0.0101	0.0100
0.0222	0.0221	0.0218	0.0214	0.0209	0.0203	0.0195	0.0187	0.0179	0.0170	0.0161	0.0152	0.0143	0.0134	0.0126	0.0119	0.0113	0.0107	0.0103	0.0101	0.0100
0.0221	0.0220	0.0217	0.0213	0.0208	0.0202	0.0195	0.0187	0.0178	0.0169	0.0160	0.0151	0.0142	0.0134	0.0126	0.0119	0.0113	0.0107	0.0103	0.0101	0.0100
0.0219	0.0218	0.0216	0.0212	0.0207	0.0201	0.0193	0.0186	0.0177	0.0168	0.0160	0.0151	0.0142	0.0134	0.0126	0.0119	0.0112	0.0107	0.0103	0.0101	0.0100
0.0217	0.0216	0.0214	0.0210	0.0205	0.0199	0.0192	0.0184	0.0176	0.0167	0.0159	0.0150	0.0141	0.0133	0.0125	0.0118	0.0112	0.0107	0.0103	0.0101	0.0100
0.0215	0.0214	0.0212	0.0208	0.0203	0.0197	0.0190	0.0183	0.0175	0.0166	0.0158	0.0149	0.0140	0.0132	0.0125	0.0118	0.0112	0.0107	0.0103	0.0101	0.0100
0.0213	0.0212	0.0209	0.0206	0.0201	0.0195	0.0188	0.0181	0.0173	0.0165	0.0156	0.0148	0.0140	0.0132	0.0124	0.0118	0.0112	0.0107	0.0103	0.0101	0.0100
0.0210	0.0209	0.0207	0.0203	0.0198	0.0193	0.0186	0.0179	0.0171	0.0163	0.0155	0.0147	0.0139	0.0131	0.0124	0.0117	0.0111	0.0107	0.0103	0.0101	0.0100
0.0207	0.0206	0.0204	0.0201	0.0196	0.0190	0.0184	0.0177	0.0169	0.0162	0.0154	0.0146	0.0138	0.0130	0.0123	0.0117	0.0111	0.0107	0.0103	0.0101	0.0100
0.0204	0.0204	0.0201	0.0198	0.0193	0.0188	0.0182	0.0175	0.0168	0.0160	0.0152	0.0144	0.0137	0.0129	0.0123	0.0116	0.0111	0.0106	0.0103	0.0101	0.0100
0.0201	0.0201	0.0199	0.0195	0.0191	0.0186	0.0179	0.0173	0.0166	0.0158	0.0151	0.0143	0.0136	0.0129	0.0122	0.0116	0.0111	0.0106	0.0103	0.0101	0.0100
0.0198	0.0198	0.0196	0.0192	0.0188	0.0183	0.0177	0.0171	0.0164	0.0157	0.0149	0.0142	0.0135	0.0128	0.0121	0.0115	0.0110	0.0106	0.0103	0.0101	0.0100
0.0196	0.0195	0.0193	0.0190	0.0186	0.0181	0.0175	0.0169	0.0162	0.0155	0.0148	0.0141	0.0134	0.0127	0.0121	0.0115	0.0110	0.0106	0.0103	0.0101	0.0100
0.0194	0.0193	0.0191	0.0188	0.0184	0.0179	0.0174	0.0167	0.0161	0.0154	0.0147	0.0140	0.0133	0.0126	0.0120	0.0115	0.0110	0.0106	0.0103	0.0101	0.0100
0.0193	0.0192	0.0190	0.0187	0.0183	0.0178	0.0173	0.0167	0.0160	0.0153	0.0146	0.0139	0.0133	0.0126	0.0120	0.0114	0.0110	0.0106	0.0103	0.0101	0.0100
0.0193	0.0192	0.0190	0.0187	0.0183	0.0178	0.0173	0.0167	0.0160	0.0153	0.0146	0.0139	0.0133	0.0126	0.0120	0.0114	0.0110	0.0106	0.0103	0.0101	0.0100
0.0194	0.0193	0.0191	0.0188	0.0184	0.0179	0.0174	0.0167	0.0161	0.0154	0.0147	0.0140	0.0133	0.0126	0.0120	0.0115	0.0110	0.0106	0.0103	0.0101	0.0100
0.0197	0.0196	0.0194	0.0191	0.0187	0.0182	0.0176	0.0169	0.0163	0.0156	0.0148	0.0141	0.0134	0.0127	0.0121	0.0115	0.0110	0.0106	0.0103	0.0101	0.0100
0.0201	0.0201	0.0199	0.0195	0.0191	0.0186	0.0179	0.0173	0.0166	0.0158	0.0151	0.0143	0.0136	0.0129	0.0122	0.0116	0.0111	0.0106	0.0103	0.0101	0.0100
0.0207	0.0206	0.0204	0.0200	0.0196	0.0190	0.0184	0.0177	0.0169	0.0161	0.0153	0.0145	0.0138	0.0130	0.0123	0.0117	0.0111	0.0106	0.0103	0.0101	0.0100
0.0212	0.0212	0.0209	0.0206	0.0201	0.0195	0.0188	0.0181	0.0173	0.0165	0.0156	0.0148	0.0140	0.0132	0.0124	0.0118	0.0112	0.0107	0.0103	0.0101	0.0100
0.0219	0.0218	0.0216	0.0212	0.0207	0.0200	0.0193	0.0185	0.0177	0.0168	0.0159	0.0151	0.0142	0.0134	0.0126	0.0119	0.0112	0.0107	0.0103	0.0101	0.0100
0.0226	0.0225	0.0222	0.0218	0.0213	0.0206	0.0199	0.0190	0.0182	0.0172	0.0163	0.0153	0.0144	0.0135	0.0127	0.0120	0.0113	0.0108	0.0104	0.0101	0.0100
0.0233	0.0232	0.0229	0.0225	0.0219	0.0212	0.0204	0.0195	0.0186	0.0176	0.0166	0.0157	0.0147	0.0137	0.0129	0.0121	0.0114	0.0108	0.0104	0.0101	0.0100
0.0240	0.0239	0.0236	0.0231	0.0225	0.0218	0.0209	0.0200	0.0190	0.0180	0.0170	0.0159	0.0149	0.0139	0.0130	0.0122	0.0115	0.0108	0.0104	0.0101	0.0100
0.0245	0.0244	0.0241	0.0236	0.0230	0.0222	0.0214	0.0204	0.0194	0.0183	0.0172	0.0162	0.0151	0.0141	0.0131	0.0123	0.0115	0.0109	0.0104	0.0101	0.0100
0.0249	0.0247	0.0244	0.0240	0.0233	0.0225	0.0216	0.0207	0.0196	0.0185	0.0174	0.0163	0.0152	0.0142	0.0132	0.0123	0.0115	0.0109	0.0104	0.0101	0.0100
0.0250	0.0249	0.0246	0.0241	0.0235	0.0227	0.0218	0.0208	0.0197	0.0186	0.0175	0.0164	0.0153	0.0142	0.0132	0.0123	0.0116	0.0109	0.0104	0.0101	0.0100
0.0250	0.0249	0.0246	0.0241	0.0235	0.0227	0.0218	0.0208	0.0197	0.0186	0.0175	0.0164	0.0153	0.0142	0.0132	0.0124	0.0116	0.0109	0.0104	0.0101	0.0100
0.0250	0.0249	0.0246	0.0241	0.0234	0.0227	0.0218	0.0208	0.0197	0.0186	0.0175	0.0164	0.0153	0.0142	0.0132	0.0123	0.0116	0.0109	0.0104	0.0101	0.0100
0.0249	0.0248	0.0245	0.0240	0.0234	0.0226	0.0217	0.0207	0.0197	0.0186	0.0175	0.0163	0.0153	0.0142	0.0132	0.0123	0.0116	0.0109	0.0104	0.0101	0.0100
0.0249	0.0248	0.0245	0.0240	0.0233	0.0225	0.0217	0.0207	0.0196	0.0185	0.0174	0.0163	0.0152	0.0142	0.0132	0.0123	0.0115	0.0109	0.0104	0.0101	0.0100
0.0248	0.0247	0.0244	0.0239	0.0233	0.0225	0.0216	0.0206	0.0196	0.0185	0.0174	0.0163	0.0152	0.0142	0.0132	0.0123	0.0115	0.0109	0.0104	0.0101	0.0100
0.0247	0.0246	0.0243	0.0238	0.0232	0.0224	0.0215	0.0206	0.0195	0.0185	0.0174	0.0163	0.0152	0.0141	0.0132	0.0123	0.0115	0.0109	0.0104	0.0101	0.0100
0.0246	0.0245	0.0242	0.0237	0.0231	0.0223	0.0214	0.0205	0.0194	0.0184	0.0173	0.0162	0.0151	0.0141	0.0131	0.0123	0.0115	0.0109	0.0104	0.0101	0.0100
0.0243	0.0242	0.0239	0.0235	0.0229	0.0221	0.0212	0.0203	0.0193	0.0182	0.0172	0.0161	0.0151	0.0140	0.0131	0.0122	0.0115	0.0109	0.0104	0.0101	0.0100
0.0227	0.0226	0.0224	0.0219	0.0213	0.0206	0.0198	0.0190	0.0180	0.0170	0.0160	0.0150	0.0140	0.0131	0.0122	0.0114	0.0107	0.0101	0.0097	0.0094	0.0093
0.0211	0.0210	0.0208	0.0203	0.0198	0.0192	0.0184	0.0176	0.0167	0.0158	0.0149	0.0140	0.0130	0.0122	0.0114	0.0106	0.0100	0.0094	0.0090	0.0088	0.0087
0.0195	0.0194	0.0192	0.0188	0.0183	0.0177	0.0170	0.0162	0.0154	0.0146	0.0137	0.0129	0.0120	0.0112	0.0105	0.0098	0.0092	0.0087	0.0083	0.0081	0.0080
0.0179	0.0178	0.0176	0.0172	0.0168	0.0162	0.0156	0.0149	0.0142	0.0134	0.0126	0.0118	0.0110	0.0103	0.0096	0.0090	0.0084	0.0080	0.0076	0.0074	0.0073
0.0162	0.0162	0.0160	0.0157	0.0152	0.0147	0.0142	0.0135	0.0129	0.0122	0.0114	0.0107	0.0100	0.0094	0.0087	0.0082	0.0077	0.0072	0.0069	0.0067	0.0067
0.0146	0.0145	0.0144	0.0141	0.0137	0.0133	0.0127	0.0122	0.0116	0.0109	0.0103	0.0097	0.0090	0.0084	0.0079	0.0073	0.0069	0.0065	0.0062	0.0061	0.0060
0.0130	0.0129	0.0128	0.0125	0.0122	0.0118	0.0113	0.0108	0.0103	0.0097	0.0092	0.0086	0.0080	0.0075	0.0070	0.0065	0.0061	0.0058	0.0055	0.0054	0.0053
0.0114	0.0113	0.0112	0.0110	0.0107	0.0103	0.0099	0.0095	0.0090	0.0085	0.0080	0.0075	0.0070	0.0066	0.0061	0.0057	0.0054	0.0051	0.0049	0.0047	0.0047
0.0097	0.0097	0.0096	0.0094	0.0091	0.0088	0.0085	0.0081	0.0077	0.0073	0.0069	0.0064	0.0060	0.0056	0.0052	0.0049	0.0046	0.0043	0.0042	0.0040	0.0040
0.0081	0.0081	0.0080	0.0078	0.0076	0.0074	0.0071	0.0068	0.0064	0.0061	0.0057	0.0054	0.0050	0.0047	0.0044	0.0041	0.0038	0.0036	0.0035	0.0034	0.0033
0.0065	0.0065	0.0064	0.0063	0.0061	0.0059	0.0057	0.0054	0.0051	0.0049	0.0046	0.0043	0.0040	0.0037	0.0035	0.0033	0.0031	0.0029	0.0028	0.0027	0.0027
0.0049	0.0048	0.0048	0.0047	0.0046	0.0044	0.0042	0.0041	0.0039	0.0036	0.0034	0.0032	0.0030	0.0028	0.0026	0.0024	0.0023	0.0022	0.0021	0.0020	0.0020
0.0032	0.0032	0.0032	0.0031	0.0030	0.0029	0.0028	0.0027	0.0026	0.0024	0.0023	0.0021	0.0020	0.0019	0.0017	0.0016	0.0015	0.0014	0.0014	0.0013	0.0013
0.0016	0.0016	0.0016	0.0016	0.0015	0.0015	0.0014	0.0014	0.0013	0.0012	0.0011	0.0011	0.0010	0.0009	0.0009	0.0008	0.0008	0.0007	0.0007	0.0007	0.0007
0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000
0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000
0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000
0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000
0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000
0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000	0.0000
"""

def _load_fm_matrix(txt: str) -> np.ndarray:
    txt = txt.strip()
    if (not txt) or ("PEGA AQU칈" in txt) or ("PEGA AQUI" in txt):
        return np.zeros((111, 21), dtype=float)
    return np.loadtxt(StringIO(txt), delimiter="\t")

fm_h = _load_fm_matrix(FM_H_TXT)
fm_m = _load_fm_matrix(FM_M_TXT)

if fm_h.shape != (111, 21):
    st.warning(f"fm_h tiene shape {fm_h.shape}. Se esperaba (111,21). Se usar치 matriz de ceros.")
    fm_h = np.zeros((111, 21), dtype=float)
if fm_m.shape != (111, 21):
    st.warning(f"fm_m tiene shape {fm_m.shape}. Se esperaba (111,21). Se usar치 matriz de ceros.")
    fm_m = np.zeros((111, 21), dtype=float)

# =========================================================
# 2) INPUTS: TABLAS BASE qx (SPP-2025-S) 0-110
# =========================================================
q_hombres_base = np.array([
    0.00526052722195369, 0.000377573574683949, 0.000368785906623848, 0.000349219544180083, 0.00032097758038413,
    0.0002864776373774, 0.000248224179348885, 0.000209452375547418, 0.000173203215617787, 0.000142865537594185,
    0.000122123983771038, 0.000115036445489258, 0.00012639724416585, 0.000161878479835624, 0.000227983925239216,
    0.000332011890345976, 0.000419920578677227, 0.000500579761848741, 0.000569016893557277, 0.000623707100048523,
    0.000690464898647695, 0.000734519364072467, 0.000761077957405564, 0.000775238988840247, 0.000781527498991398,
    0.000783774436229987, 0.00078518431002837, 0.000788148899673906, 0.000794255311046242, 0.000804368195738244,
    0.000818757558695088, 0.00083727794723047, 0.000859548996068777, 0.000885123831364279, 0.000913645507432358,
    0.000944813071756375, 0.000978241535878419, 0.00101345155213057, 0.00105012386611217, 0.0010883768497645,
    0.00112879248227974, 0.00117225203328422, 0.00121981835386321, 0.0012727563462712, 0.00133253043009447,
    0.00140075666262585, 0.00147912608567992, 0.00156938858967635, 0.00167332126474187, 0.00179267918792184,
    0.00192909002000212, 0.0020839709040396, 0.00225845721755158, 0.00245340457903159, 0.00266949412967369,
    0.00290748795374294, 0.00316857219593588, 0.00345476565817071, 0.00376932395933277, 0.00411710272322959,
    0.00450471248793166, 0.00494053081706002, 0.0054345892992021, 0.00599840546862686, 0.00664460901574639,
    0.00738657117171082, 0.00823788411590906, 0.00921162956411433, 0.0103195973878692, 0.0115721788670448,
    0.0129787751725082, 0.0145478333390977, 0.01628674242491, 0.0182041903117874, 0.0203138520384644,
    0.0226340368108806, 0.0251846622457092, 0.0279862401738191, 0.0310654950783106, 0.0344600296300744,
    0.038212282556454, 0.0423657933478447, 0.046968917356797, 0.0520644915985513, 0.0576886691485409,
    0.0638799797429742, 0.0706781404270348, 0.0781373664002667, 0.0863201922313814, 0.0952927105406334,
    0.105149184428404, 0.116459614666869, 0.128899238019294, 0.141600993118813, 0.155602640327382,
    0.17043770538163, 0.186048550933076, 0.202376921792886, 0.219365973890509, 0.236961448141553,
    0.255112281980367, 0.27377086360971, 0.292893066627437, 0.312438154961571, 0.332368615687682,
    0.352649955925322, 0.371543160533318, 0.390545632533398, 0.409628615351423, 0.428766003505835,
    1.0
])

q_mujeres_base = np.array([
    0.00344333551425604, 0.000273198588001602, 0.000250999530470955, 0.000221131476464794, 0.000189630599219363,
    0.000160017625500219, 0.000134786580057289, 0.000115135612772363, 0.000101164245302515, 0.0000924966545438692,
    0.0000883146475879009, 0.0000877948019023276, 0.0000901840995072122, 0.000095440557485772, 0.000104098265766327,
    0.000118072772866149, 0.00012986967077202, 0.000142402142631857, 0.000155187688391133, 0.000168102351519782,
    0.000181280066019723, 0.000195059241598977, 0.000209545803957693, 0.000224859893318381, 0.000241102830314702,
    0.000258196621812207, 0.000278128247193566, 0.000291184867524017, 0.000299626656947697, 0.000306524219806197,
    0.000315103675730647, 0.000328158243947916, 0.000347592328179671, 0.00037401957068745, 0.000406820920774933,
    0.000444405172418786, 0.000484536935835483, 0.000524864817247044, 0.000563619566768679, 0.000600264490865971,
    0.000635709962705061, 0.000671878081493946, 0.00071090504003529, 0.000754376518952622, 0.000802932908143207,
    0.000856463520174053, 0.000914798623910806, 0.000978542101292987, 0.00104948651767755, 0.00113033403881313,
    0.00122373241023181, 0.00133107097538146, 0.00145157541442257, 0.00158217668890827, 0.00171832539839655,
    0.00185576395005447, 0.00199282995571883, 0.00213254029052324, 0.00228359115135575, 0.00245985201005196,
    0.0026783545952187, 0.00295632021740655, 0.00330803226829946, 0.00374232154706333, 0.00426124746423318,
    0.00486037031654884, 0.0055308479835416, 0.00626250612197264, 0.00704738120636447, 0.0078832963026803,
    0.00877599486250189, 0.00973688281044129, 0.0107804291276072, 0.0119270515586315, 0.0132036921624903,
    0.0146370498228139, 0.0162543872642357, 0.018088724266634, 0.0201782727804631, 0.0225717277595187,
    0.0253266955371419, 0.0285018625181639, 0.0321583983651666, 0.0363483762615505, 0.0411157771703588,
    0.0465035412397594, 0.0525437319924597, 0.0592714160702584, 0.0667214489155665, 0.0749040068337621,
    0.0838374952662448, 0.0940143783428071, 0.104975091504375, 0.116664239960081, 0.128997472054893,
    0.142225865390459, 0.156370048202817, 0.171373993525494, 0.187252477085999, 0.204020413304947,
    0.221692856036161, 0.240284999308558, 0.259812178069839, 0.28028986893197, 0.301733690918448,
    0.324159406213365, 0.345335222153168, 0.367228247107341, 0.389838481075885, 0.4131659240588,
    1.0
])

# =========================================================
# 3) PROYECCI칍N qx POR COHORTE CON MEJORAS
# =========================================================
def obtener_qx_proyectada(sexo: str, edad: int, a침o_objetivo: int) -> float:
    """
    qx(edad, a침o_objetivo) = q_base(edad) * _{y=2026}^{a침o_objetivo} (1 - fm(edad,y))
    Convenci칩n:
    - base q corresponde al a침o 2025.
    - fm matrices: columnas 2026..2045 (20 cols).
    - si a침o_objetivo > 2045: se congela fm del 2045 (col 20).
    """
    q_base = q_hombres_base if sexo == "Masculino" else q_mujeres_base
    mejoras = fm_h if sexo == "Masculino" else fm_m

    if a침o_objetivo <= 2025:
        return float(q_base[edad])

    prod = 1.0
    for y in range(2026, a침o_objetivo + 1):
        if y <= 2046:
            g = float(mejoras[edad, y - 2026])
        else:
            g = float(mejoras[edad, 20])
        prod *= (1.0 - g)

    return float(q_base[edad]) * prod

def obtener_tabla_cohorte(sexo: str, a침o_nacimiento: int) -> np.ndarray:
    """
    Retorna qx[0..110] para la cohorte (nacida en a침o_nacimiento):
    qx(edad) evaluada en el a침o calendario en que cumple esa edad.
    """
    q = np.zeros(111, dtype=float)
    for edad in range(111):
        a침o_cal = a침o_nacimiento + edad
        q[edad] = obtener_qx_proyectada(sexo, edad, a침o_cal)
    q = np.clip(q, 0.0, 1.0)
    return q

# =========================================================
# 4) FUNCIONES ACTUARIALES
# =========================================================
def obtener_prob_supervivencia_a_edad(edad: int, qx: np.ndarray) -> float:
    """Probabilidad de sobrevivir desde 0 hasta edad (exclusive)."""
    if edad <= 0:
        return 1.0
    return float(np.prod(1.0 - qx[:edad]))

def factor_anualidad_pension(sexo: str, qx: np.ndarray, tasa_desc: float, tipo_renta: str, frec_nombre: str,
                             a침os_temporal: int, edad_jub: int) -> tuple[float, int]:
    """
    Factor de anualidad (en "a침os", ajustado por frecuencia) consistente con tu primer c칩digo:
    - Vitalicia: suma desde edad_jub a 110, con supervivencia post-jub usando qx (cohorte/base)
    - Temporal: n a침os, sin mortalidad post (como en tu primer c칩digo). (Puedes extender si lo deseas)
    - Ajuste de (k-1)/(2k) para pagos fraccionados.
    """
    v = 1.0 / (1.0 + tasa_desc)
    px = 1.0 - qx

    map_frec = {"Mensual": 12, "Bimestral": 6, "Trimestral": 4, "Anual": 1}
    k = map_frec[frec_nombre]

    fa = 0.0
    if tipo_renta == "Vitalicia":
        t_p = 1.0
        for t in range(edad_jub, 111):
            fa += t_p * (v ** (t - edad_jub))
            if t < 110:
                t_p *= px[t]
        fa -= (k - 1) / (2 * k)
    else:
        n = int(a침os_temporal)
        for t in range(n):
            fa += (v ** t)
        fa -= (k - 1) / (2 * k) * (1 - v ** n)

    return float(fa), int(k)

def fondo_necesario_para_pension(pension_por_pago: float, k: int, factor_anualidad: float) -> float:
    """Fondo en edad_jub (al jubilar) requerido para pagar la pensi칩n."""
    return float((pension_por_pago * k) * factor_anualidad)

def capital_semilla_financiero(fondo_necesario: float, tasa_acum: float, edad_jub: int) -> float:
    """Capital semilla (edad 0) sin ponderar por supervivencia: consistente con 1er c칩digo."""
    return float(fondo_necesario / ((1.0 + tasa_acum) ** edad_jub))

def capital_semilla_esperado(fondo_necesario: float, tasa_acum: float, edad_jub: int, qx: np.ndarray) -> float:
    """
    Costo esperado (si interpretas que el Estado solo 'incurre' si la persona llega a jubilar):
    cap_financiero * p(sobrevive a jub).
    """
    p_jub = obtener_prob_supervivencia_a_edad(edad_jub, qx)
    return float(capital_semilla_financiero(fondo_necesario, tasa_acum, edad_jub) * p_jub)

def aporte_mensual_necesario(fondo_necesario: float, tasa_acum: float, qx: np.ndarray,
                            edad_inicio_ap: int, edad_fin_ap: int, edad_jub: int) -> float:
    """
    Aporte mensual consistente con tu 1er c칩digo:
    denom = 풖_{t=edad_inicio}^{edad_fin-1} p(0->t) * (1+i)^(edad_jub - t)
    aporte_mensual = (fondo_necesario / denom) / 12
    """
    denom = 0.0
    for t in range(edad_inicio_ap, edad_fin_ap):
        p_t = obtener_prob_supervivencia_a_edad(t, qx)
        denom += p_t * ((1.0 + tasa_acum) ** (edad_jub - t))
    if denom <= 0:
        return 0.0
    return float((fondo_necesario / denom) / 12.0)

def pension_desde_fondo(fondo: float, factor_anualidad: float, k: int) -> float:
    """Pensi칩n por pago (seg칰n frecuencia) derivada de fondo a jubilaci칩n."""
    return float((fondo / factor_anualidad) / k)

# =========================================================
# 5) STREAMLIT UI
# =========================================================
st.set_page_config(page_title="CEIP: Capital semilla y aportes capitalizables", layout="wide")
# AQUI IMAGEN
st.title("游낁 CEIP - Simulador Actuarial")
st.markdown(
    "En cumplimiento de la Resoluci칩n SBS N.춿 04043-2025, se pone a disposici칩n del CEIP una herramienta de c치lculo actuarial "
    "del capital semilla y del aporte mensual, orientada a establecer una alternativa sostenible a la pensi칩n no contributiva Pensi칩n 65."
)

with st.sidebar:
    # AQUI IMAGEN
    st.header("丘뙖잺 Configuraci칩n")
    modo_calculo = st.radio("Modo de C치lculo:", ["Pensi칩n objetivo", "Inversi칩n/aportes"], index=0)

    with st.expander("游녻 Perfil del Beneficiario", expanded=True):
        sexo = st.selectbox("Sexo:", ["Masculino", "Femenino"], index=1)
        edad_jub = st.slider("Edad de Jubilaci칩n:", 50, 75, 65)

        st.subheader("Periodo de Aporte")
        edad_inicio_aporte = st.slider("Comienzo de aporte (edad):", 0, 25, 6)
        edad_fin_aporte = st.slider("Fin de aporte (edad):", edad_inicio_aporte + 1, 40, 18)
        a침os_aporte = edad_fin_aporte - edad_inicio_aporte

    with st.expander("游늳 Par치metros Financieros"):
        st.subheader("Ingresar Tasas de Acumulaci칩n y Descuento")

        t_acum = st.number_input(
            "Tasa Acumulaci칩n (Ahorro)",
            min_value=0.0, max_value=20.0,
            value=4.3, step=0.1, format="%.2f"
        ) / 100.0

        t_jub = st.number_input(
            "Tasa Descuento (Renta)",
            min_value=0.0, max_value=20.0,
            value=4.3, step=0.1, format="%.2f"
        ) / 100.0

        st.subheader("Tipo de Pensi칩n")
        frecuencia_pension = st.selectbox("Frecuencia:", ["Mensual", "Bimestral", "Trimestral", "Anual"], index=1)
        tipo_pension = st.selectbox("Tipo:", ["Vitalicia", "Temporal"], index=0)
        a침os_t_temporal = st.number_input("A침os (si es temporal):", value=20, min_value=5, max_value=60)

    with st.expander("游빏 Proyecciones por cohorte", expanded=False):
        usar_mejoras = st.checkbox("Aplicar factores de mejora en proyecciones", value=True)
        a침o_nacimiento = st.number_input("A침o de nacimiento por cohorte:", min_value=2025, max_value=2136, value=2026, step=1)
        st.caption("Si desactivas mejoras, se usa qx base 2025 (SPP-2025-S).")

# =========================================================
# 6) SELECCI칍N DE qx (base vs cohorte)
# =========================================================
if usar_mejoras:
    qx = obtener_tabla_cohorte(sexo, int(a침o_nacimiento))
else:
    qx = q_hombres_base if sexo == "Masculino" else q_mujeres_base

# Factor anualidad + frecuencia
fa, k_pagos = factor_anualidad_pension(
    sexo=sexo, qx=qx,
    tasa_desc=t_jub,
    tipo_renta=tipo_pension,
    frec_nombre=frecuencia_pension,
    a침os_temporal=int(a침os_t_temporal),
    edad_jub=int(edad_jub)
)

# =========================================================
# 7) MOTOR PRINCIPAL
# =========================================================
if modo_calculo == "Pensi칩n objetivo":
    monto_pension_obj = st.number_input(f"Pensi칩n deseada ({frecuencia_pension}) (S/):", value=350.0)

    fondo_nec = fondo_necesario_para_pension(monto_pension_obj, k_pagos, fa)
    cap_semilla_fin = capital_semilla_financiero(fondo_nec, t_acum, int(edad_jub))
    aporte_mens = aporte_mensual_necesario(
        fondo_necesario=fondo_nec,
        tasa_acum=t_acum,
        qx=qx,
        edad_inicio_ap=int(edad_inicio_aporte),
        edad_fin_ap=int(edad_fin_aporte),
        edad_jub=int(edad_jub)
    )

    # Opcional: costo esperado (para transparencia)
    cap_semilla_exp = capital_semilla_esperado(fondo_nec, t_acum, int(edad_jub), qx)

    st.divider()
    c1, c2 = st.columns(2)
    c1.metric("Capital Semilla Necesario", f"S/ {cap_semilla_fin:,.2f}")
    c2.metric("Aporte Mensual Necesario", f"S/ {aporte_mens:,.2f}")

    cap_semilla = cap_semilla_fin
    monto_aporte_mensual = aporte_mens

    fondo_semilla = cap_semilla_fin * ((1.0 + t_acum) ** int(edad_jub))
    fondo_mensual_esperado = 0.0
    for t in range(int(edad_inicio_aporte), int(edad_fin_aporte)):
        p_t = obtener_prob_supervivencia_a_edad(t, qx)
        fondo_mensual_esperado += (monto_aporte_mensual * 12.0) * p_t * ((1.0 + t_acum) ** (int(edad_jub) - t))

    pension_semilla = pension_desde_fondo(fondo_semilla, fa, k_pagos)
    pension_aportes = pension_desde_fondo(fondo_mensual_esperado, fa, k_pagos)

else:
    col_a, col_b = st.columns(2)
    with col_a:
        input_cap_semilla = st.number_input("Capital Semilla (S/):", value=5500.0)
    with col_b:
        input_aporte_mensual = st.number_input("Aporte Mensual (S/):", value=55.0)

    # Fondo a jubilaci칩n desde semilla
    fondo_semilla = float(input_cap_semilla * ((1.0 + t_acum) ** int(edad_jub)))
    pension_semilla = pension_desde_fondo(fondo_semilla, fa, k_pagos)

    # Fondo a jubilaci칩n desde aportes (misma l칩gica)
    fondo_mensual_esperado = 0.0
    for t in range(int(edad_inicio_aporte), int(edad_fin_aporte)):
        p_t = obtener_prob_supervivencia_a_edad(t, qx)
        fondo_mensual_esperado += (float(input_aporte_mensual) * 12.0) * p_t * ((1.0 + t_acum) ** (int(edad_jub) - t))
    pension_aportes = pension_desde_fondo(fondo_mensual_esperado, fa, k_pagos)

    cap_semilla = float(input_cap_semilla)
    monto_aporte_mensual = float(input_aporte_mensual)

    st.divider()
    st.subheader("游늵 Comparativa de Resultados")
    data_resumen = {
        "Concepto": ["Fondo Proyectado a Jubilaci칩n", f"Pensi칩n {frecuencia_pension} (por pago)"],
        "Capital Semilla": [f"S/ {fondo_semilla:,.2f}", f"S/ {pension_semilla:,.2f}"],
        "Aportes Mensuales": [f"S/ {fondo_mensual_esperado:,.2f}", f"S/ {pension_aportes:,.2f}"]
    }
    st.table(pd.DataFrame(data_resumen))

# =========================================================
# 8) BLOQUE DE CRECIMIENTO DEL FONDO
# =========================================================
st.subheader("游늳 Crecimiento del fondo")
edades = np.arange(0, edad_jub + 1)

progreso_semilla = [cap_semilla * (1 + t_acum) ** t for t in edades]

progreso_mensual = []
acum_m = 0.0
for t in edades:
    if edad_inicio_aporte <= t < edad_fin_aporte:
        p_t = obtener_prob_supervivencia_a_edad(t, qx)
        acum_m = (acum_m + (monto_aporte_mensual * 12) * p_t) * (1 + t_acum)
    elif t >= edad_fin_aporte:
        acum_m *= (1 + t_acum)
    else:
        acum_m = 0.0
    progreso_mensual.append(acum_m)

df_progreso = pd.DataFrame(
    {"Capital semilla": progreso_semilla, "Aportes mensuales": progreso_mensual},
    index=edades
).round(2)

# Mantengo tu estilo de 치rea y colores
st.area_chart(df_progreso, color=["#06369d", "#64b5f6"])
# =========================================================
# 9) RESULTADOS VECTORIALES
# =========================================================
with st.expander("游늷 Proyecciones por cohortes de nacimiento (2026-2126+)", expanded=False):
    st.subheader("游늵 Proyecciones: Capital Semilla y Aporte Mensual requeridos")

    col1, col2 = st.columns(2)
    with col1:
        pension_target_vec = st.number_input(
            "Pensi칩n objetivo (S/):",
            value=350.0,
            key="pension_target_vec"
        )
        sexo_vec = st.selectbox("Sexo:", ["Masculino", "Femenino"], index=(0 if sexo == "Masculino" else 1), key="sexo_vec")

    with col2:
        rango_analisis = st.slider("Rango de proyecci칩n por cohortes de a침os de nacimiento:", 2025, 2136, (2026, 2086), key="rango_analisis")

    # Par치metros del UI actual (para consistencia)
    edad_jub_v = int(edad_jub)
    edad_ini_v = int(edad_inicio_aporte)
    edad_fin_v = int(edad_fin_aporte)

    a침os = np.arange(rango_analisis[0], rango_analisis[1] + 1, dtype=int)
    v_semilla_fin = []
    v_semilla_exp = []
    v_aportes = []

    for an in a침os:
        qx_tmp = obtener_tabla_cohorte(sexo_vec, int(an)) if usar_mejoras else (q_hombres_base if sexo_vec == "Masculino" else q_mujeres_base)

        fa_tmp, k_tmp = factor_anualidad_pension(
            sexo=sexo_vec, qx=qx_tmp,
            tasa_desc=t_jub,
            tipo_renta=tipo_pension,
            frec_nombre=frecuencia_pension,
            a침os_temporal=int(a침os_t_temporal),
            edad_jub=edad_jub_v
        )

        fondo_tmp = fondo_necesario_para_pension(float(pension_target_vec), k_tmp, fa_tmp)
        cap_fin_tmp = capital_semilla_financiero(fondo_tmp, t_acum, edad_jub_v)
        cap_exp_tmp = capital_semilla_esperado(fondo_tmp, t_acum, edad_jub_v, qx_tmp)
        ap_tmp = aporte_mensual_necesario(fondo_tmp, t_acum, qx_tmp, edad_ini_v, edad_fin_v, edad_jub_v)

        v_semilla_fin.append(cap_fin_tmp)
        v_semilla_exp.append(cap_exp_tmp)
        v_aportes.append(ap_tmp)

    df_vec = pd.DataFrame({
        "Proyecci칩n por cohortes de a침os de nacimiento": a침os,
        "Capital Semilla": v_semilla_fin,
        "Aporte Mensual": v_aportes
    }).set_index("Proyecci칩n por cohortes de a침os de nacimiento").round(2)

    col1a, col2a = st.columns(2)

    with col1a:
        st.write("### Tabla de valores")
        st.dataframe(df_vec.style.format({
            "Capital Semilla": "S/ {:,.2f}",
            "Aporte Mensual": "S/ {:,.2f}"
        }))
    
    with col2a:
        st.write("### Proyecci칩n de capital semilla y aportes mensuales capitalizables S/")
        st.line_chart(df_vec)

    csv_bytes = df_vec.reset_index().to_csv(index=False).encode("utf-8-sig")
    st.download_button(
        label="Descargar CSV (proyecci칩n por cohortes de a침os de nacimiento)",
        data=csv_bytes,
        file_name="cohortes_capital_semilla_aportes.csv",
        mime="text/csv"
    )
# =========================================================
# 10) SECCI칍N FINAL: RESUMEN EJECUTIVO
# =========================================================
with st.expander("游 Resumen ejecutivo:", expanded=False):
    st.subheader("Tabla resumen")
    
    resumen_dict = {
        "Sexo": sexo,
        "Edad jubilaci칩n": int(edad_jub),
        "A침os aporte": int(a침os_aporte),
        "Edad inicio aporte": int(edad_inicio_aporte),
        "Edad fin aporte": int(edad_fin_aporte),
        "Tasa acumulaci칩n": t_acum,
        "Tasa descuento": t_jub,
        "Frecuencia pensi칩n": frecuencia_pension,
        "Tipo pensi칩n": tipo_pension,
        "Usa mejoras (cohorte)": bool(usar_mejoras),
        "A침o cohorte": int(a침o_nacimiento),
        "Factor anualidad": round(float(fa),2),
    }
    
    if modo_calculo == "Pensi칩n objetivo":
        resumen_dict["Pensi칩n objetivo"] = round(float(monto_pension_obj), 2)
        resumen_dict["Capital semilla"] = round(float(cap_semilla),0)
        resumen_dict["Aporte mensual requerido"] = round(float(monto_aporte_mensual), 1)
    else:
        resumen_dict["Capital semilla - input"] = round(float(cap_semilla), 0)
        resumen_dict["Aporte mensual - input"] = round(float(monto_aporte_mensual), 0)
        resumen_dict["Pensi칩n con capital semilla"] = round(float(pension_semilla), 1)
        resumen_dict["Pensi칩n con aportes capitalizables"] = round(float(pension_aportes), 1)
    
    df_resumen = pd.DataFrame.from_dict(resumen_dict, orient="index", columns=["Valor"])
    st.dataframe(df_resumen)
    
    st.caption(
        "Se usan las tablas de mortalidad y factores de mejora del SPP 2025 - (TM SPP-2025-S)."
    )
